#!/usr/bin/env bash

set -ex

date=$(date '+%Y-%m-%d')
backup_dir='/Volumes/files/Backups'

function things () {
  path="$HOME/Library/Group Containers/JLMPQHK86H.com.culturedcode.ThingsMac/ThingsData-RE5PT"
  file="Things Database.thingsdatabase"
  cp -r "${path}/${file}" "${backup_dir}/Things/ThingsDatabase-${date}.thingsdatabase"
}

function obsidian () {
  path="$HOME/Library/Mobile Documents/iCloud~md~obsidian/Documents/Notes"

  cp -r "${path}" "${backup_dir}/Obsidian/Notes-${date}"
}

function all() {
  obsidian
  things
}

TARGET=${@:-all}

for target in ${TARGET}; do
  echo "Running ${target}..."
  ${target}
  echo "${target} complete."
done
